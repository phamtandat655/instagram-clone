"use strict";(self.webpackChunkinstagram_clone=self.webpackChunkinstagram_clone||[]).push([[292],{292:function(n,i,e){e.r(i),e.d(i,{default:function(){return g}});var o=e(4165),a=e(5861),t=e(3433),s=e(9439),r=e(9448),l=e.n(r),c=e(9922),d=e(184),u=l().bind({wrapper:"Message_wrapper__jF7LO",container:"Message_container__WrUiq",myMessage:"Message_myMessage__wYnER","image-wrapper":"Message_image-wrapper__FPrO5","message-time":"Message_message-time__U9E+g","message-wrapper":"Message_message-wrapper__aDsVO"});var v=function(n){var i=n.message,e=n.isMyMessage,o=(n.name,n.img),a=n.time;return(0,d.jsx)("div",{className:u("wrapper"),children:(0,d.jsxs)("div",{className:u("container",{myMessage:e}),children:[(0,d.jsx)("div",{className:u("image-wrapper"),children:(0,d.jsx)("img",{alt:"messageImage",src:o})}),(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:u("message-wrapper"),children:(0,d.jsx)("p",{children:i})}),(0,d.jsx)("p",{className:u("message-time"),children:a})]})]})})},m=e(2791),x=e(4446),_=e(2948),p=e(7689),b=e(7799),h=e(9514),f=l().bind({wrapper:"Inbox_wrapper__Y05jn",container:"Inbox_container__0wCTD",inboxList:"Inbox_inboxList__-pA8l","inboxList__account-wrapper":"Inbox_inboxList__account-wrapper__VhUmF",inboxList__title:"Inbox_inboxList__title__7-Bsq","inboxList__title-wrong":"Inbox_inboxList__title-wrong__DPWuS",inboxList__account:"Inbox_inboxList__account__aoZiz",activeAccount:"Inbox_activeAccount__UeORF",inboxChats:"Inbox_inboxChats__Nxl+G","inboxChats-top":"Inbox_inboxChats-top__hslf4","icon-back":"Inbox_icon-back__Hl4Lt","inboxChats-mid":"Inbox_inboxChats-mid__oc89z","inboxChats-bottom":"Inbox_inboxChats-bottom__4fOCp","chatInput-wrapper":"Inbox_chatInput-wrapper__iexNy",responsiveInboxList:"Inbox_responsiveInboxList__daHoX",responsiveInboxChats:"Inbox_responsiveInboxChats__2Aj4J"});var g=function(){var n,i,e,r,l=(0,x.i)(),u=l.inboxes,g=l.getUserByEmail,w=l.userEmailList,j=(0,_._)().user,I=(0,p.TH)().pathname,L=(0,m.useRef)(null),C=(0,m.useState)([]),N=(0,s.Z)(C,2),k=N[0],Z=N[1],M=(0,m.useState)([]),S=(0,s.Z)(M,2),y=S[0],E=S[1],D=(0,m.useState)(""),U=(0,s.Z)(D,2),A=U[0],F=U[1],O=(0,m.useState)([]),H=(0,s.Z)(O,2),V=H[0],J=H[1],P=(0,p.s0)(),R=(0,m.useState)(!1),T=(0,s.Z)(R,2),q=T[0],z=T[1],B=I.slice(7);(0,m.useEffect)((function(){z(!!B),B&&w&&0!==(null===w||void 0===w?void 0:w.length)&&!w.includes(B)&&P("/NotFound/inbox/".concat(B));var n=[],i=[];u.forEach((function(e){i.push(null===e||void 0===e?void 0:e.id);var o=(0,t.Z)(null===e||void 0===e?void 0:e.id.split("??"));o.includes(null===j||void 0===j?void 0:j.email)&&(n.push(e),B&&o.includes(B)&&E(null===e||void 0===e?void 0:e.inboxesList.sort((function(n,i){return n.timestampSecond-i.timestampSecond})).reverse()))})),Z(n),J(i)}),[u,j,B,P,w]);var G=function(){var n=(0,a.Z)((0,o.Z)().mark((function n(i){var e,s,r,l,c,d;return(0,o.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(A.trim().length<=0)){n.next=2;break}return n.abrupt("return");case 2:if(L.current.scrollIntoView({behavior:"smooth"}),e=B+"??"+(null===j||void 0===j?void 0:j.email),s=(null===j||void 0===j?void 0:j.email)+"??"+B,r=g(null===j||void 0===j?void 0:j.email),V.includes(e)||V.includes(s)){n.next=10;break}return n.next=9,(0,b.pl)((0,b.JU)(h.db,"inboxes","".concat(e)),{inboxesList:[{timestampSecond:Math.floor(Date.now()/1e3),timestamp:b.EK.now(),username:null===r||void 0===r||null===(l=r.information)||void 0===l?void 0:l.name,useremail:null===r||void 0===r||null===(c=r.information)||void 0===c?void 0:c.email,useravatar:null===r||void 0===r||null===(d=r.information)||void 0===d?void 0:d.avatar,chat:A}]});case 9:F("");case 10:u.forEach(function(){var n=(0,a.Z)((0,o.Z)().mark((function n(i){var e,a,s,l;return(0,o.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null===i||void 0===i||!i.id.includes(null===j||void 0===j?void 0:j.email)||null===i||void 0===i||!i.id.includes(B)){n.next=5;break}return F(""),l=(0,b.JU)(h.db,"inboxes","".concat(null===i||void 0===i?void 0:i.id)),n.next=5,(0,b.r7)(l,{inboxesList:[].concat((0,t.Z)(y),[{timestampSecond:Math.floor(Date.now()/1e3),timestamp:b.EK.now(),username:null===r||void 0===r||null===(e=r.information)||void 0===e?void 0:e.name,useremail:null===r||void 0===r||null===(a=r.information)||void 0===a?void 0:a.email,useravatar:null===r||void 0===r||null===(s=r.information)||void 0===s?void 0:s.avatar,chat:A}])});case 5:case"end":return n.stop()}}),n)})));return function(i){return n.apply(this,arguments)}}());case 11:case"end":return n.stop()}}),n)})));return function(i){return n.apply(this,arguments)}}(),K=function(n){return n.split("??").find((function(n){return n!==(null===j||void 0===j?void 0:j.email)}))};return(0,d.jsx)("div",{className:f("wrapper"),children:(0,d.jsxs)("div",{className:f("container"),children:[(0,d.jsx)("div",{className:f("inboxList",{responsiveInboxList:q}),children:(0,d.jsxs)("div",{className:f("inboxList__account-wrapper"),children:[(0,d.jsx)("p",{className:f("inboxList__title"),children:"Tin nh\u1eafn"}),k.length<=0&&(0,d.jsx)("div",{className:f("inboxList__title-wrong"),children:"Hi\u1ec7n kh\xf4ng c\xf3 tin nh\u1eafn n\xe0o !"}),k&&k.map((function(n,i){var e,o,a,t=K(null===n||void 0===n?void 0:n.id),s=g(t),r=null===n||void 0===n?void 0:n.inboxesList.sort((function(n,i){return n.timestampSecond-i.timestampSecond})).reverse();return(0,d.jsx)("div",{className:f("inboxList__account",{activeAccount:I&&B===t}),onClick:function(n){return i=t,F(""),P("/inbox/".concat(i)),void L.current.scrollIntoView({behavior:"smooth"});var i},children:(0,d.jsx)(c.Z,{note:null===(e=r[0])||void 0===e?void 0:e.chat,lengthDesc:30,name:null===s||void 0===s||null===(o=s.information)||void 0===o?void 0:o.name,img:null===s||void 0===s||null===(a=s.information)||void 0===a?void 0:a.avatar})},i)}))]})}),(0,d.jsxs)("div",{className:f("inboxChats",{responsiveInboxChats:q}),children:[(0,d.jsxs)("div",{className:f("inboxChats-top"),children:[(0,d.jsx)("div",{className:f("icon-back"),onClick:function(n){z(!1),P("/inbox")},children:"<"}),B&&(0,d.jsx)("div",{onClick:function(n){var i,e;return P("/personalPage/".concat(null===(i=g(B))||void 0===i||null===(e=i.information)||void 0===e?void 0:e.email))},children:(0,d.jsx)(c.Z,{name:(null===(n=g(B))||void 0===n||null===(i=n.information)||void 0===i?void 0:i.name)||"",img:(null===(e=g(B))||void 0===e||null===(r=e.information)||void 0===r?void 0:r.avatar)||""})})]}),(0,d.jsxs)("div",{className:f("inboxChats-mid"),children:[(0,d.jsx)("div",{ref:L}),B&&y.map((function(n,i){var e=new Date(1e3*(null===n||void 0===n?void 0:n.timestampSecond));return(0,d.jsx)(v,{message:null===n||void 0===n?void 0:n.chat,isMyMessage:(null===n||void 0===n?void 0:n.useremail)===(null===j||void 0===j?void 0:j.email),name:null===n||void 0===n?void 0:n.username,img:null===n||void 0===n?void 0:n.useravatar,time:e.toLocaleString()},i)}))]}),(0,d.jsx)("div",{className:f("inboxChats-bottom"),children:B&&(0,d.jsxs)("form",{className:f("chatInput-wrapper"),onSubmit:function(n){n.preventDefault(),G()},children:[(0,d.jsx)("input",{value:A,onChange:function(n){F(n.target.value)},type:"text",placeholder:"Nh\u1eadp tin nh\u1eafn..."}),(0,d.jsx)("button",{children:"G\u1eedi"})]})})]})]})})}}}]);
//# sourceMappingURL=292.f1f401d4.chunk.js.map