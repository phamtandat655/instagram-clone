{"version":3,"file":"static/js/677.22b4c0d8.chunk.js","mappings":"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","sources":["pages/AccountEdit/AccountEdit.js","webpack://instagram-clone/./src/pages/AccountEdit/AccountEdit.module.scss?fceb"],"sourcesContent":["import classNames from 'classnames/bind';\r\nimport styles from './AccountEdit.module.scss';\r\n\r\nimport { useState, useEffect, useRef } from 'react';\r\nimport { UserAuth } from '../../Context/AuthContext';\r\nimport { onSnapshot, doc, updateDoc } from 'firebase/firestore';\r\nimport { getStorage, ref, uploadBytesResumable, getDownloadURL } from 'firebase/storage';\r\nimport { db } from '../../firebase';\r\n\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst cx = classNames.bind(styles);\r\n\r\nfunction AccountEdit() {\r\n    const [avatar, setAvatar] = useState('');\r\n    const [name, setName] = useState('');\r\n    const [desc, setDesc] = useState('');\r\n    const [progress, setProgress] = useState(0);\r\n    const [hideBar, setHideBar] = useState(true);\r\n    const { user } = UserAuth();\r\n\r\n    const fileRef = useRef();\r\n    const nav = useNavigate();\r\n\r\n    useEffect(() => {\r\n        onSnapshot(doc(db, 'users', `${user.email}`), (doc) => {\r\n            setAvatar(doc.data()?.information.avatar);\r\n            setName(doc.data()?.information.name);\r\n            setDesc(doc.data()?.information.desc);\r\n        });\r\n    }, [user?.email]);\r\n\r\n    useEffect(() => {\r\n        if (progress === 100) {\r\n            setHideBar(true);\r\n        } else {\r\n            setHideBar(false);\r\n        }\r\n    }, [progress]);\r\n\r\n    const handleSubmit = async () => {\r\n        const docRef = doc(db, 'users', `${user.email}`);\r\n        await updateDoc(docRef, {\r\n            information: {\r\n                email: user?.email,\r\n                name,\r\n                desc,\r\n                avatar,\r\n            },\r\n        });\r\n        nav(`/personalPage/${user?.email}`);\r\n    };\r\n    const handleImgUpload = () => {\r\n        fileRef.current.click();\r\n    };\r\n\r\n    const storage = getStorage();\r\n    const handleChangeImg = (e) => {\r\n        const imgFile = e.target.files[0];\r\n        const storageRef = ref(storage, `images/${imgFile.name}`);\r\n        const uploadTask = uploadBytesResumable(storageRef, imgFile);\r\n\r\n        uploadTask.on(\r\n            'state_changed',\r\n            (snapshot) => {\r\n                const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;\r\n                setProgress(progress);\r\n                switch (snapshot.state) {\r\n                    case 'paused':\r\n                        // console.log('Upload is paused');\r\n                        break;\r\n                    case 'running':\r\n                        // console.log('Upload is running');\r\n                        break;\r\n                    default:\r\n                        break;\r\n                }\r\n            },\r\n            (error) => {\r\n                alert(error.message);\r\n            },\r\n            () => {\r\n                getDownloadURL(uploadTask.snapshot.ref).then(async (downloadURL) => {\r\n                    await updateDoc(doc(db, 'users', `${user?.email}`), {\r\n                        information: {\r\n                            avatar: downloadURL,\r\n                            name,\r\n                            desc,\r\n                        },\r\n                    });\r\n                });\r\n            },\r\n        );\r\n    };\r\n\r\n    return (\r\n        <div className={cx('wrapper')}>\r\n            <div className={cx('account-wrapper')}>\r\n                <span\r\n                    className={cx('progress', { hide: hideBar })}\r\n                    style={{\r\n                        width: `${progress}%`,\r\n                    }}\r\n                ></span>\r\n                <div className={cx('avatar-wrapper')}>\r\n                    <img alt=\"avatar\" src={avatar} />\r\n                </div>\r\n                <div className={cx('emailAndAvatar-wrapper')}>\r\n                    <p>{user?.email}</p>\r\n                    <div onClick={handleImgUpload}>\r\n                        <span>Thay đổi ảnh đại diện</span>\r\n                        <input type=\"file\" onChange={handleChangeImg} hidden ref={fileRef} />\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div className={cx('input-wrapper')}>\r\n                <span>Email : </span>\r\n                <input type=\"text\" disabled value={user?.email || ''} onChange={(e) => user?.email} />\r\n            </div>\r\n            <div className={cx('input-wrapper')}>\r\n                <span>Tên : </span>\r\n                <input\r\n                    type=\"text\"\r\n                    onChange={(e) => {\r\n                        setName(e.target.value);\r\n                    }}\r\n                    value={name || ''}\r\n                />\r\n            </div>\r\n            <div className={cx('input-wrapper')}>\r\n                <span>Mô tả : </span>\r\n                <input\r\n                    type=\"text\"\r\n                    onChange={(e) => {\r\n                        setDesc(e.target.value);\r\n                    }}\r\n                    value={desc || ''}\r\n                />\r\n            </div>\r\n            <div className={cx('submit-btn')} onClick={handleSubmit}>\r\n                <button>Gửi</button>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default AccountEdit;\r\n","// extracted by mini-css-extract-plugin\nexport default {\"wrapper\":\"AccountEdit_wrapper__5zLbe\",\"progress\":\"AccountEdit_progress__Gfi+v\",\"hide\":\"AccountEdit_hide__HZXoK\",\"avatar-wrapper\":\"AccountEdit_avatar-wrapper__+DwlO\",\"account-wrapper\":\"AccountEdit_account-wrapper__0X8Xs\",\"emailAndAvatar-wrapper\":\"AccountEdit_emailAndAvatar-wrapper__HYV7p\",\"input-wrapper\":\"AccountEdit_input-wrapper__49-yu\",\"submit-btn\":\"AccountEdit_submit-btn__uTEU5\"};"],"names":["cx","classNames","useState","avatar","setAvatar","name","setName","desc","setDesc","progress","setProgress","hideBar","setHideBar","user","UserAuth","fileRef","useRef","nav","useNavigate","useEffect","onSnapshot","doc","db","email","data","information","handleSubmit","docRef","updateDoc","storage","getStorage","className","hide","style","width","alt","src","onClick","current","click","type","onChange","e","imgFile","target","files","storageRef","ref","uploadTask","uploadBytesResumable","on","snapshot","bytesTransferred","totalBytes","state","error","alert","message","getDownloadURL","then","downloadURL","hidden","disabled","value"],"sourceRoot":""}